<div class="container" *ngIf="issue">
  <h1>Issue #{{issue.id}}</h1>

  <div class="row">
    <div class="col left">
      <div>
        <h2>Summary</h2>
        <p [innerHTML]="issue.summary | markdown: {source: source}"></p>
      </div>

      <div>
        <h2>Comments</h2>
        <div class="card mb-1" *ngFor='let comment of issue.comments'>
          <h6 class="card-header d-flex flex-row">
            <div class="flex-grow-1">{{ comment.commenterName }} commented</div>
            <div ngbDropdown>
              <button id="commentDrop" ngbDropdownToggle>
                <fa-icon [icon]="faEllipsis" size="xs"></fa-icon>
              </button>
              <div ngbDropdownMenu aria-labelledby="commentDrop">
                <button class="dropdown-item"
                        (click)="removeComment(issue.comments.indexOf(comment))">Delete</button>
              </div>
            </div>
          </h6>
          <div class="card-body" [innerHTML]="comment.content | markdown: {source: source}"></div>
        </div>

        <div class="loader mx-auto" *ngIf="isAddingComment"></div>
        <div class="card mt-1">
          <form *ngIf="!isAddingComment"
                #commentForm="ngForm"
                (ngSubmit)="addComment(commentContent.value)"
                class="comment-section">
            <div class="card-body">
              <textarea type="text" class="form-control" placeholder="Leave a comment" #commentContent></textarea>
            </div>
            <div class="d-flex flex-row justify-content-end card-footer">
              <button class="btn btn-secondary mr-1"
                      (click)="addComment(commentContent.value, true)">Close and comment</button>
              <button type="submit" class="btn btn-success">Comment</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="issue-details col right">
      <h2>Issue details</h2>

      <p><span>Project ID:</span> {{issue.projectId}}</p> <!-- create hyperlink back to project -->
      <p><span>Status:</span> {{issue.status}}</p>
      <p><span>Labels:</span> {{issue.labels}}</p>
      <p><span>Submitter:</span> {{issue.submitterName}}</p>
      <p *ngIf="issue.timeCreated"><span>Created:</span> {{issue.timeCreated | amFromUnix | amCalendar}}</p>
      <p *ngIf="issue.timeUpdated"><span>Last updated:</span> {{issue.timeUpdated | amFromUnix | amCalendar}}</p>
      <p *ngIf="issue.timeClosed"><span>Last closed:</span> {{issue.timeClosed | amFromUnix | amCalendar}}</p>
    </div>
  </div>



</div>

